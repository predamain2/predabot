<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Player Stats</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Orbitron:wght@600;700;800;900&display=swap" rel="stylesheet">
	<style>
		* {
			box-sizing: border-box;
			margin: 0;
			padding: 0;
		}

		body {
			background: radial-gradient(1000px 500px at 80% -10%, rgba(220, 20, 60, 0.25), transparent 60%),
				radial-gradient(1000px 500px at 10% 110%, rgba(124, 58, 237, 0.25), transparent 60%),
				#0f0f12;
			color: #fff;
			font-family: 'Inter', sans-serif;
			min-height: 100vh;
			display: flex;
			align-items: flex-start;
			justify-content: center;
			padding: 20px;
		}

		/* Complete redesign to match reference image with comprehensive layout */
		.dashboard {
			width: 100%;
			max-width: 1400px;
			display: grid;
			grid-template-columns: 2fr 1fr;
			gap: 20px;
		}

		.card {
			background: linear-gradient(145deg, #1a1a1f 0%, #0f0f12 100%);
			border: 1px solid rgba(255,255,255,0.08);
			border-radius: 12px;
			box-shadow: 0 8px 32px rgba(0,0,0,0.6);
		}

		/* Header with clan tag and improved layout */
		.header {
			grid-column: 1 / -1;
			padding: 20px 24px;
			display: flex;
			align-items: center;
			gap: 20px;
		}

		.avatar { 
			width: 80px; 
			height: 80px; 
			border-radius: 12px; 
			border: 2px solid rgba(255,255,255,0.1); 
			object-fit: cover; 
			flex-shrink: 0;
		}

		.player-info {
			flex: 1;
		}

		.player-name {
			display: flex;
			align-items: center;
			gap: 12px;
			margin-bottom: 6px;
		}

		.clan-tag {
			color: rgba(255,255,255,0.6);
			font-weight: 400;
		}

		.player-name h1 {
			font-size: 28px;
			font-weight: 800;
			margin: 0;
		}

		.player-id {
			font-size: 12px;
			color: rgba(255,255,255,0.6);
		}

		/* Left column layout */
		.left-column {
			display: flex;
			flex-direction: column;
			gap: 20px;
		}

		.section {
			padding: 20px;
		}

		.section-title {
			font-weight: 700;
			font-size: 14px;
			letter-spacing: 1px;
			color: rgba(255,255,255,0.7);
			text-transform: uppercase;
			margin-bottom: 20px;
			display: flex;
			align-items: center;
			gap: 8px;
		}

		.section-icon {
			width: 16px;
			height: 16px;
			opacity: 0.7;
		}

		/* Enhanced statistics section */
		.stats-layout {
			display: grid;
			grid-template-columns: auto 1fr;
			gap: 24px;
			align-items: start;
		}

		.kd-display {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 12px;
		}

		.kd-circle {
			width: 160px;
			height: 160px;
			border-radius: 50%;
			background: radial-gradient(closest-side, #0f0f12 70%, transparent 72% 100%),
				conic-gradient(from 180deg, #3b82f6 calc(var(--killsP, 50) * 1%), #ef4444 0);
			position: relative;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.kd-circle::before {
			content: '';
			position: absolute;
			inset: 10px;
			border-radius: 50%;
			background: linear-gradient(145deg, #1a1a1f, #0f0f12);
		}

		.kd-value {
			position: relative;
			font-family: 'Orbitron', monospace;
			font-size: 32px;
			font-weight: 800;
			z-index: 1;
		}

		.kd-label {
			font-size: 11px;
			color: rgba(255,255,255,0.6);
			text-transform: uppercase;
			letter-spacing: 1px;
			margin-top: 4px;
		}

		.kd-breakdown {
			display: flex;
			gap: 8px;
		}

		.kd-stat {
			background: rgba(255,255,255,0.04);
			border: 1px solid rgba(255,255,255,0.08);
			border-radius: 8px;
			padding: 8px 12px;
			text-align: center;
		}

		.kd-stat-label {
			font-size: 10px;
			color: rgba(255,255,255,0.6);
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.kd-stat-value {
			font-weight: 800;
			font-size: 16px;
			margin-top: 2px;
		}

		.kd-stat.kills .kd-stat-value { color: #3b82f6; }
		.kd-stat.deaths .kd-stat-value { color: #ef4444; }

		/* Comprehensive stats grid */
		.performance-grid {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 12px;
		}

		.stat-card {
			background: rgba(255,255,255,0.03);
			border: 1px solid rgba(255,255,255,0.08);
			border-radius: 10px;
			padding: 16px;
			position: relative;
		}

		.stat-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 8px;
		}

		.stat-label {
			font-size: 11px;
			color: rgba(255,255,255,0.6);
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.stat-value {
			font-family: 'Orbitron', monospace;
			font-size: 24px;
			font-weight: 800;
			margin: 8px 0;
		}

		.stat-bar {
			height: 6px;
			border-radius: 3px;
			background: rgba(255,255,255,0.08);
			position: relative;
			overflow: hidden;
		}

		.stat-bar::after {
			content: '';
			position: absolute;
			left: 0;
			top: 0;
			bottom: 0;
			width: var(--progress, 0%);
			background: linear-gradient(90deg, #3b82f6, #7c3aed);
		}

		.stat-rating {
			font-size: 10px;
			font-weight: 600;
			padding: 2px 6px;
			border-radius: 4px;
			text-transform: uppercase;
		}

		.stat-rating.strong { background: rgba(59, 130, 246, 0.2); color: #60a5fa; }
		.stat-rating.low { background: rgba(239, 68, 68, 0.2); color: #f87171; }
		.stat-rating.stable { background: rgba(245, 158, 11, 0.2); color: #fbbf24; }

		/* Enhanced map statistics */
		.map-section {
			display: grid;
			grid-template-columns: auto 1fr;
			gap: 20px;
		}

		.winrate-display {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 12px;
		}

		.winrate-circle {
			width: 120px;
			height: 120px;
			border-radius: 50%;
			background: radial-gradient(closest-side, #0f0f12 70%, transparent 72% 100%),
				conic-gradient(#7c3aed calc(var(--winrate, 0) * 1%), rgba(255,255,255,0.08) 0);
			position: relative;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.winrate-circle::before {
			content: '';
			position: absolute;
			inset: 8px;
			border-radius: 50%;
			background: linear-gradient(145deg, #1a1a1f, #0f0f12);
		}

		.winrate-value {
			position: relative;
			font-family: 'Orbitron', monospace;
			font-size: 20px;
			font-weight: 800;
			z-index: 1;
		}

		.winrate-label {
			font-size: 10px;
			color: rgba(255,255,255,0.6);
			text-transform: uppercase;
			letter-spacing: 1px;
		}

		.wl-breakdown {
			display: flex;
			gap: 8px;
		}

		.wl-stat {
			padding: 6px 10px;
			border-radius: 6px;
			font-size: 12px;
			font-weight: 700;
		}

		.wl-stat.wins {
			background: rgba(34,197,94,0.15);
			color: #34d399;
			border: 1px solid rgba(34,197,94,0.3);
		}

		.wl-stat.losses {
			background: rgba(239,68,68,0.15);
			color: #f87171;
			border: 1px solid rgba(239,68,68,0.3);
		}

		/* Map cards with images */
		.map-grid {
			display: grid;
			grid-template-columns: repeat(4, 1fr);
			gap: 12px;
		}

		.map-card {
			background: rgba(255,255,255,0.03);
			border: 1px solid rgba(255,255,255,0.08);
			border-radius: 10px;
			padding: 12px;
			position: relative;
		}

		.map-header {
			display: flex;
			align-items: center;
			gap: 8px;
			margin-bottom: 8px;
		}

		.map-icon {
			width: 24px;
			height: 24px;
			border-radius: 4px;
			background: rgba(255,255,255,0.1);
			object-fit: cover;
			border: 1px solid rgba(255,255,255,0.1);
		}

		.map-name {
			font-weight: 700;
			font-size: 13px;
		}

		.map-record {
			display: flex;
			gap: 4px;
			margin-bottom: 4px;
		}

		.map-w, .map-l {
			padding: 2px 6px;
			border-radius: 4px;
			font-size: 10px;
			font-weight: 600;
		}

		.map-w { background: rgba(34,197,94,0.15); color: #34d399; }
		.map-l { background: rgba(239,68,68,0.15); color: #f87171; }

		.map-stats-text {
			font-size: 11px;
			color: rgba(255,255,255,0.7);
		}

		/* Right sidebar enhancements */
		.right-sidebar {
			display: flex;
			flex-direction: column;
			gap: 20px;
		}

		.level-section {
			display: flex;
			align-items: center;
			gap: 12px;
			margin-bottom: 16px;
		}

		.level-badge {
			width: 32px;
			height: 32px;
			border-radius: 8px;
			display: flex;
			align-items: center;
			justify-content: center;
			font-weight: 800;
		}

		/* Level color coding */
		.level-badge.level-1 {
			background: linear-gradient(135deg, #6b7280, #4b5563);
			color: #fff;
		}

		.level-badge.level-2, .level-badge.level-3 {
			background: linear-gradient(135deg, #22c55e, #16a34a);
			color: #fff;
		}

		.level-badge.level-4, .level-badge.level-5, .level-badge.level-6, .level-badge.level-7 {
			background: linear-gradient(135deg, #fbbf24, #f59e0b);
			color: #000;
		}

		.level-badge.level-8, .level-badge.level-9 {
			background: linear-gradient(135deg, #f97316, #ea580c);
			color: #fff;
		}

		.level-badge.level-10 {
			background: linear-gradient(135deg, #ef4444, #dc2626);
			color: #fff;
		}

		.level-info h3 {
			font-size: 16px;
			margin-bottom: 2px;
		}

		/* Level number color coding */
		.level-info h3.level-1 {
			color: #9ca3af;
		}

		.level-info h3.level-2, .level-info h3.level-3 {
			color: #22c55e;
		}

		.level-info h3.level-4, .level-info h3.level-5, .level-info h3.level-6, .level-info h3.level-7 {
			color: #fbbf24;
		}

		.level-info h3.level-8, .level-info h3.level-9 {
			color: #f97316;
		}

		.level-info h3.level-10 {
			color: #ef4444;
		}

		.level-progress {
			height: 8px;
			background: rgba(255,255,255,0.08);
			border-radius: 4px;
			overflow: hidden;
			position: relative;
		}

		.level-progress-bar {
			height: 100%;
			width: var(--level-progress, 0%);
			transition: width 0.3s ease;
		}

		/* Level progress bar color coding */
		.level-progress-bar.level-1 {
			background: linear-gradient(90deg, #6b7280, #4b5563);
		}

		.level-progress-bar.level-2, .level-progress-bar.level-3 {
			background: linear-gradient(90deg, #22c55e, #16a34a);
		}

		.level-progress-bar.level-4, .level-progress-bar.level-5, .level-progress-bar.level-6, .level-progress-bar.level-7 {
			background: linear-gradient(90deg, #fbbf24, #f59e0b);
		}

		.level-progress-bar.level-8, .level-progress-bar.level-9 {
			background: linear-gradient(90deg, #f97316, #ea580c);
		}

		.level-progress-bar.level-10 {
			background: linear-gradient(90deg, #ef4444, #dc2626);
		}

		.level-meter {
			margin-top: 8px;
		}

		.level-meter-info {
			display: flex;
			justify-content: space-between;
			font-size: 11px;
			color: rgba(255,255,255,0.6);
			margin-bottom: 4px;
		}

		.current-elo {
			font-weight: 600;
			color: #fff;
		}

		.info-grid {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			gap: 12px;
			margin-bottom: 16px;
		}

		.info-item {
			display: flex;
			align-items: center;
			gap: 8px;
		}

		.info-icon {
			width: 16px;
			height: 16px;
			opacity: 0.6;
		}

		.info-text {
			font-size: 12px;
		}

		.info-label {
			color: rgba(255,255,255,0.6);
		}

		.info-value {
			font-weight: 600;
		}

		/* League and leaderboard */
		.league-section {
			margin-bottom: 16px;
		}

		.league-header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			margin-bottom: 8px;
		}

		.league-name {
			font-weight: 600;
			font-size: 14px;
		}

		.league-badge {
			width: 24px;
			height: 24px;
			background: rgba(255,255,255,0.1);
			border-radius: 4px;
		}

		.leaderboard {
			margin-bottom: 16px;
		}

		.leaderboard-item {
			display: flex;
			align-items: center;
			gap: 8px;
			padding: 6px 0;
			border-bottom: 1px solid rgba(255,255,255,0.05);
		}

		.rank-number {
			font-weight: 800;
			font-size: 12px;
			color: rgba(255,255,255,0.6);
			width: 20px;
		}

		.player-avatar {
			width: 20px;
			height: 20px;
			border-radius: 4px;
			background: rgba(255,255,255,0.1);
			object-fit: cover;
			border: 1px solid rgba(255,255,255,0.1);
		}

		.leaderboard-header {
			display: flex;
			align-items: center;
			gap: 12px;
			margin-bottom: 12px;
			padding-bottom: 8px;
			border-bottom: 1px solid rgba(255,255,255,0.1);
		}

		.af-logo {
			width: 32px;
			height: 32px;
			border-radius: 6px;
			object-fit: cover;
		}

		.leaderboard-title {
			font-weight: 700;
			font-size: 14px;
			letter-spacing: 1px;
			color: rgba(255,255,255,0.9);
			text-transform: uppercase;
		}

		.player-name-small {
			font-size: 12px;
			font-weight: 500;
		}

		/* Recent matches enhanced */
		.matches-grid {
			display: grid;
			grid-template-columns: repeat(7, 1fr);
			gap: 6px;
			margin-bottom: 12px;
		}

		.match-result {
			height: 28px;
			border-radius: 6px;
			display: flex;
			align-items: center;
			justify-content: center;
			font-weight: 800;
			font-size: 12px;
		}

		.match-result.win {
			background: rgba(34,197,94,0.15);
			color: #34d399;
			border: 1px solid rgba(34,197,94,0.3);
		}

		.match-result.loss {
			background: rgba(239,68,68,0.15);
			color: #f87171;
			border: 1px solid rgba(239,68,68,0.3);
		}

		.matches-overflow {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 6px;
		}

		/* Responsive design */
		@media (max-width: 1200px) {
			.dashboard {
				grid-template-columns: 1fr;
				max-width: 900px;
			}
			
			.performance-grid {
				grid-template-columns: repeat(2, 1fr);
			}
			
			.map-grid {
				grid-template-columns: repeat(3, 1fr);
			}
		}

		@media (max-width: 768px) {
			.stats-layout {
				grid-template-columns: 1fr;
				gap: 16px;
			}
			
			.map-section {
				grid-template-columns: 1fr;
				gap: 16px;
			}
			
			.performance-grid {
				grid-template-columns: 1fr;
			}
			
			.map-grid {
				grid-template-columns: repeat(2, 1fr);
			}
			
			.matches-grid {
				grid-template-columns: repeat(5, 1fr);
			}
		}
	</style>
</head>
<body>
	<div class="dashboard">
		<!-- Enhanced header with clan tag support -->
		<div class="card header">
			<img class="avatar" src="{{ stats.avatar_url|default('', true) }}" alt="Player Avatar">
			<div class="player-info">
				<div class="player-name">
					<h1><span class="clan-tag">#{{ stats.clan_tag|default('???', true) }}</span> {{ stats.name|default('Player', true) }}</h1>
				</div>
				<div class="player-id">ID: {{ stats.player_id|default('-', true) }}</div>
			</div>
		</div>

		<div class="left-column">
			<!-- Enhanced statistics section -->
			<div class="card section">
				<div class="section-title">
					<svg class="section-icon" viewBox="0 0 24 24" fill="currentColor">
						<path d="M3 3v18h18v-2H5V3H3zm4 14h2v-6H7v6zm4 0h2V9h-2v8zm4 0h2v-4h-2v4z"/>
					</svg>
					Statistic
				</div>
				<div class="stats-layout">
					<div class="kd-display">
						<div class="kd-circle" style="--killsP: {{ (stats.kills / (stats.kills + stats.deaths) * 100) if (stats.kills + stats.deaths) > 0 else 0 }}">
							<div class="kd-value">{{ stats.kd|default('0.00', true) }}</div>
						</div>
						<div class="kd-label">Kill/Deaths</div>
						<div class="kd-breakdown">
							<div class="kd-stat kills">
								<div class="kd-stat-label">K</div>
								<div class="kd-stat-value">{{ stats.kills|default(0, true) }}</div>
							</div>
							<div class="kd-stat deaths">
								<div class="kd-stat-label">D</div>
								<div class="kd-stat-value">{{ stats.deaths|default(0, true) }}</div>
							</div>
						</div>
					</div>
					<div class="performance-grid">
						<div class="stat-card">
							<div class="stat-header">
								<div class="stat-label">Rating</div>
								<div class="stat-rating strong">Strong</div>
							</div>
							<div class="stat-value">{{ "%.2f"|format(stats.rating or 1.13) }}</div>
							<div class="stat-bar" style="--progress: {{ ((stats.rating or 1.13) / 3.0 * 100)|round }}%"></div>
						</div>
						<div class="stat-card">
							<div class="stat-header">
								<div class="stat-label">AVG</div>
								<div class="stat-rating strong">Strong</div>
							</div>
							<div class="stat-value">{{ stats.avg|default('18', true) }}</div>
							<div class="stat-bar" style="--progress: {{ (stats.avg or 18) * 4 }}%"></div>
						</div>
						<div class="stat-card">
							<div class="stat-header">
								<div class="stat-label">Impact</div>
								<div class="stat-rating strong">Strong</div>
							</div>
							<div class="stat-value">{{ "%.2f"|format(stats.impact or 1.21) }}</div>
							<div class="stat-bar" style="--progress: {{ ((stats.impact or 1.21) / 3.0 * 100)|round }}%"></div>
						</div>
						<div class="stat-card">
							<div class="stat-header">
								<div class="stat-label">KPR</div>
								<div class="stat-rating strong">Strong</div>
							</div>
							<div class="stat-value">{{ "%.2f"|format(stats.kpr or 0.92) }}</div>
							<div class="stat-bar" style="--progress: {{ ((stats.kpr or 0.92) * 100)|round }}%"></div>
						</div>
						<div class="stat-card">
							<div class="stat-header">
								<div class="stat-label">Assists</div>
								<div class="stat-rating low">Low</div>
							</div>
							<div class="stat-value">{{ stats.assists|default('29', true) }}</div>
							<div class="stat-bar" style="--progress: {{ (stats.assists or 29) * 2 }}%"></div>
						</div>
						<div class="stat-card">
							<div class="stat-header">
								<div class="stat-label">SVR</div>
								<div class="stat-rating stable">Stable</div>
							</div>
							<div class="stat-value">{{ "%.2f"|format(stats.svr or 0.32) }}</div>
							<div class="stat-bar" style="--progress: {{ ((stats.svr or 0.32) * 100)|round }}%"></div>
						</div>
					</div>
				</div>
			</div>

			<!-- Enhanced map statistics -->
			<div class="card section">
				<div class="section-title">
					<svg class="section-icon" viewBox="0 0 24 24" fill="currentColor">
						<path d="M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM10 5.47l4 1.4v11.66l-4-1.4V5.47z"/>
					</svg>
					Map Statistic
				</div>
				<div class="map-section">
					<div class="winrate-display">
						<div class="winrate-circle" style="--winrate: {{ stats.win_rate or 50 }}">
							<div class="winrate-value">{{ stats.win_rate|default('50', true) }}%</div>
						</div>
						<div class="winrate-label">Win Rate</div>
						<div class="wl-breakdown">
							<div class="wl-stat wins">W {{ stats.wins|default('5', true) }}</div>
							<div class="wl-stat losses">L {{ stats.losses|default('5', true) }}</div>
						</div>
					</div>
					<div class="map-grid">
							{% for m in stats.maps or [
								{'name': 'Sandstone', 'wins': 0, 'losses': 0, 'kd': '0.00', 'win_rate': '0'},
								{'name': 'Rust', 'wins': 0, 'losses': 0, 'kd': '0.00', 'win_rate': '0'},
								{'name': 'Province', 'wins': 0, 'losses': 0, 'kd': '0.00', 'win_rate': '0'},
								{'name': 'Hanami', 'wins': 0, 'losses': 0, 'kd': '0.00', 'win_rate': '0'},
								{'name': 'Breeze', 'wins': 0, 'losses': 0, 'kd': '0.00', 'win_rate': '0'},
								{'name': 'Zone7', 'wins': 0, 'losses': 0, 'kd': '0.00', 'win_rate': '0'},
								{'name': 'Dune', 'wins': 0, 'losses': 0, 'kd': '0.00', 'win_rate': '0'}
							] %}
							<div class="map-card">
								<div class="map-header">
									<img class="map-icon" src="maps/{{ m.name|lower }}.png" alt="{{ m.name }} Map" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
									<div class="map-icon" style="display: none;"></div>
									<div class="map-name">{{ m.name }}</div>
								</div>
								<div class="map-record">
									<div class="map-w">W = {{ m.wins|default(0, true) }}</div>
									<div class="map-l">L = {{ m.losses|default(0, true) }}</div>
								</div>
								<div class="map-stats-text">K/D = {{ m.kd|default('0.00', true) }}</div>
								<div class="map-stats-text">W/R = {{ m.win_rate|default('0', true) }}%</div>
							</div>
							{% endfor %}
					</div>
				</div>
			</div>
		</div>

		<div class="right-sidebar">
			<!-- Level and player info -->
			<div class="card section">
				<div class="level-section">
					<div class="level-badge level-{{ stats.level|default('1', true) }}">{{ stats.level|default('1', true) }}</div>
					<div class="level-info">
						<h3 class="level-{{ stats.level|default('1', true) }}">Level {{ stats.level|default('1', true) }}</h3>
						<div class="level-meter">
							<div class="level-meter-info">
								<span class="current-elo">{{ stats.elo|default('100', true) }} ELO</span>
								<span>{{ stats.elo_next|default('501', true) }} ELO</span>
							</div>
							<div class="level-progress">
								<div class="level-progress-bar level-{{ stats.level|default('1', true) }}" style="--level-progress: {{ stats.level_progress|default('0', true) }}%"></div>
							</div>
						</div>
					</div>
				</div>
				
				<div class="info-grid">
					<div class="info-item">
						<svg class="info-icon" viewBox="0 0 24 24" fill="currentColor">
							<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
						</svg>
						<div class="info-text">
							<div class="info-label">Playtime</div>
							<div class="info-value">{{ stats.playtime|default('0h', true) }}</div>
						</div>
					</div>
					<div class="info-item">
						<svg class="info-icon" viewBox="0 0 24 24" fill="currentColor">
							<path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
						</svg>
						<div class="info-text">
							<div class="info-label">Join Date</div>
							<div class="info-value">{{ stats.join_date|default('11.07.2025', true) }}</div>
						</div>
					</div>
					<div class="info-item">
						<svg class="info-icon" viewBox="0 0 24 24" fill="currentColor">
							<path d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
						</svg>
						<div class="info-text">
							<div class="info-label">Games</div>
							<div class="info-value">{{ stats.games|default('10', true) }}</div>
						</div>
					</div>
					<div class="info-item">
						<svg class="info-icon" viewBox="0 0 24 24" fill="currentColor">
							<path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
						</svg>
						<div class="info-text">
							<div class="info-label">MVP</div>
							<div class="info-value">{{ stats.mvp|default('2', true) }}</div>
						</div>
					</div>
				</div>

				<div class="league-section">
					<div class="league-header">
						<div class="league-name">{{ stats.league|default('Default', true) }}</div>
						<div class="league-badge"></div>
					</div>
				</div>

				<div class="leaderboard">
					<div class="leaderboard-header">
						<img class="af-logo" src="af_logo.png" alt="AF Logo">
						<div class="leaderboard-title">Leaderboard</div>
					</div>
					{% for player in stats.leaderboard or [
						{'rank': '1', 'name': 'f3ktori', 'avatar': ''},
						{'rank': '2', 'name': 'wohayo', 'avatar': ''},
						{'rank': '3', 'name': 'NoName77', 'avatar': ''},
						{'rank': '712', 'name': stats.name|default('imdone', true), 'avatar': stats.avatar_url|default('', true)}
					] %}
					<div class="leaderboard-item">
						<div class="rank-number">#{{ player.rank }}</div>
						<img class="player-avatar" src="{{ player.avatar|default('', true) }}" alt="{{ player.name }} Avatar" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
						<div class="player-avatar" style="display: none;"></div>
						<div class="player-name-small">{{ player.name }}</div>
					</div>
					{% endfor %}
				</div>
			</div>

			<!-- Enhanced recent matches -->
			<div class="card section">
				<div class="section-title">
					<svg class="section-icon" viewBox="0 0 24 24" fill="currentColor">
						<path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/>
					</svg>
					Recent Matches
				</div>
				<div class="matches-grid">
					{% for r in (stats.recent or ['L', 'L', 'W', 'L', 'W', 'L', 'W'])[:7] %}
					<div class="match-result {% if r == 'W' %}win{% else %}loss{% endif %}">{{ r }}</div>
					{% endfor %}
				</div>
				{% if (stats.recent|length or 7) > 7 %}
				<div class="matches-overflow">
					{% for r in (stats.recent or ['W', 'W', 'L'])[7:10] %}
					<div class="match-result {% if r == 'W' %}win{% else %}loss{% endif %}">{{ r }}</div>
					{% endfor %}
				</div>
				{% endif %}
			</div>
		</div>
	</div>
	<script>
		// ELO tier configuration from config.py
		const ELO_TIERS = [
			{level: 1, min: 100, max: 500},
			{level: 2, min: 501, max: 750},
			{level: 3, min: 751, max: 900},
			{level: 4, min: 901, max: 1050},
			{level: 5, min: 1051, max: 1200},
			{level: 6, min: 1201, max: 1350},
			{level: 7, min: 1351, max: 1530},
			{level: 8, min: 1531, max: 1750},
			{level: 9, min: 1751, max: 2000},
			{level: 10, min: 2001, max: 99999}
		];

		function calculateLevelProgress(elo) {
			// Find current level tier
			const currentTier = ELO_TIERS.find(tier => elo >= tier.min && elo <= tier.max) || ELO_TIERS[0];
			
			// Calculate progress within current level
			const progress = ((elo - currentTier.min) / (currentTier.max - currentTier.min)) * 100;
			
			// Find next level ELO requirement
			const nextTier = ELO_TIERS.find(tier => tier.level === currentTier.level + 1);
			const nextElo = nextTier ? nextTier.min : currentTier.max;
			
			return {
				level: currentTier.level,
				progress: Math.max(0, Math.min(100, progress)),
				nextElo: nextElo,
				currentElo: elo
			};
		}

		// Update level display on page load
		document.addEventListener('DOMContentLoaded', function() {
			// Get ELO from template or use default
			const eloElement = document.querySelector('.current-elo');
			if (eloElement) {
				const eloText = eloElement.textContent;
				const elo = parseInt(eloText.match(/\d+/)?.[0] || '100');
				
				const levelData = calculateLevelProgress(elo);
				
				// Update progress bar
				const progressBar = document.querySelector('.level-progress-bar');
				if (progressBar) {
					progressBar.style.setProperty('--level-progress', levelData.progress + '%');
				}
				
				// Update next ELO display
				const nextEloElement = document.querySelector('.level-meter-info span:last-child');
				if (nextEloElement && levelData.level < 10) {
					nextEloElement.textContent = levelData.nextElo + ' ELO';
				} else if (nextEloElement && levelData.level === 10) {
					nextEloElement.textContent = 'MAX LEVEL';
				}
			}
		});
	</script>
</body>
</html>
