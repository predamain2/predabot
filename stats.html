<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Player Stats</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Orbitron:wght@600;700;800;900&display=swap" rel="stylesheet">
	<style>
		* {
			box-sizing: border-box;
			margin: 0;
			padding: 0;
		}

		body {
			background: radial-gradient(1000px 500px at 80% -10%, rgba(220, 20, 60, 0.25), transparent 60%),
				radial-gradient(1000px 500px at 10% 110%, rgba(124, 58, 237, 0.25), transparent 60%),
				#0f0f12;
			color: #fff;
			font-family: 'Inter', sans-serif;
			min-height: 100vh;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 20px;
		}

		.dashboard {
			width: 100%;
			max-width: 1200px;
			display: grid;
			grid-template-columns: 2fr 1fr;
			gap: 16px;
		}

		.card {
			background: linear-gradient(145deg, #151519 0%, #0f0f12 100%);
			border: 1px solid rgba(255,255,255,0.08);
			border-radius: 12px;
			box-shadow: 0 8px 32px rgba(0,0,0,0.4);
		}

		/* Optimized header layout to be more compact */
		.header {
			grid-column: 1 / -1;
			padding: 16px 20px;
			display: flex;
			align-items: center;
			gap: 16px;
		}

		.avatar { 
			width: 64px; 
			height: 64px; 
			border-radius: 10px; 
			border: 1px solid rgba(255,255,255,0.1); 
			object-fit: cover; 
			flex-shrink: 0;
		}

		.player-info {
			flex: 1;
			min-width: 0;
		}

		.player-name {
			display: flex;
			align-items: center;
			gap: 8px;
			margin-bottom: 4px;
		}

		.player-name h1 {
			font-size: 22px;
			font-weight: 800;
			margin: 0;
		}

		.level-badge { 
			width: 18px; 
			height: 18px; 
		}

		.player-id {
			font-size: 11px;
			color: rgba(255,255,255,0.6);
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.points-display {
			text-align: right;
			flex-shrink: 0;
		}

		.points-label {
			font-size: 10px;
			color: rgba(255,255,255,0.6);
			text-transform: uppercase;
			letter-spacing: 1px;
			margin-bottom: 4px;
		}

		.points-value {
			font-size: 24px;
			font-weight: 800;
			font-family: 'Orbitron', monospace;
		}

		/* Improved main content layout */
		.main-content {
			display: flex;
			flex-direction: column;
			gap: 16px;
		}

		.section {
			padding: 16px;
		}

		.section-title {
			font-weight: 700;
			font-size: 12px;
			letter-spacing: 1px;
			color: rgba(255,255,255,0.7);
			text-transform: uppercase;
			margin-bottom: 16px;
		}

		/* Optimized statistics section layout */
		.stats-grid {
			display: grid;
			grid-template-columns: auto 1fr;
			gap: 20px;
			align-items: start;
		}

		.kd-display {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 12px;
		}

		.kd-circle {
			width: 140px;
			height: 140px;
			border-radius: 50%;
			background: radial-gradient(closest-side, #0f0f12 70%, transparent 72% 100%),
				conic-gradient(from 180deg, #3b82f6 calc(var(--killsP, 50) * 1%), #ef4444 0);
			position: relative;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.kd-circle::before {
			content: '';
			position: absolute;
			inset: 8px;
			border-radius: 50%;
			background: linear-gradient(145deg, #17171b, #101015);
		}

		.kd-value {
			position: relative;
			font-family: 'Orbitron', monospace;
			font-size: 24px;
			font-weight: 800;
			z-index: 1;
		}

		.kd-stats {
			display: flex;
			gap: 8px;
		}

		.kd-stat {
			background: rgba(255,255,255,0.04);
			border: 1px solid rgba(255,255,255,0.08);
			border-radius: 6px;
			padding: 6px 10px;
			text-align: center;
			min-width: 50px;
		}

		.kd-stat-label {
			font-size: 9px;
			color: rgba(255,255,255,0.6);
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.kd-stat-value {
			font-weight: 800;
			font-size: 14px;
			margin-top: 2px;
		}

		.performance-stats {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 12px;
		}

		.stat-card {
			background: rgba(255,255,255,0.03);
			border: 1px solid rgba(255,255,255,0.08);
			border-radius: 8px;
			padding: 12px;
		}

		.stat-label {
			font-size: 10px;
			color: rgba(255,255,255,0.6);
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.stat-value {
			font-family: 'Orbitron', monospace;
			font-size: 18px;
			font-weight: 800;
			margin: 4px 0;
		}

		.stat-bar {
			height: 4px;
			border-radius: 2px;
			background: rgba(255,255,255,0.08);
			position: relative;
			overflow: hidden;
		}

		.stat-bar::after {
			content: '';
			position: absolute;
			left: 0;
			top: 0;
			bottom: 0;
			width: var(--progress, 0%);
			background: linear-gradient(90deg, #ff2d55, #7c3aed);
		}

		/* Improved map statistics layout */
		.map-stats {
			display: grid;
			grid-template-columns: auto 1fr;
			gap: 16px;
			align-items: start;
		}

		.winrate-display {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 8px;
		}

		.winrate-circle {
			width: 100px;
			height: 100px;
			border-radius: 50%;
			background: radial-gradient(closest-side, #0f0f12 70%, transparent 72% 100%),
				conic-gradient(#7c3aed calc(var(--winrate, 0) * 1%), rgba(255,255,255,0.08) 0);
			position: relative;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.winrate-circle::before {
			content: '';
			position: absolute;
			inset: 8px;
			border-radius: 50%;
			background: linear-gradient(145deg, #17171b, #101015);
		}

		.winrate-value {
			position: relative;
			font-family: 'Orbitron', monospace;
			font-size: 18px;
			font-weight: 800;
			z-index: 1;
		}

		.winrate-label {
			font-size: 9px;
			color: rgba(255,255,255,0.6);
			text-transform: uppercase;
			letter-spacing: 1px;
		}

		.wl-stats {
			display: flex;
			gap: 6px;
			margin-top: 4px;
		}

		.wl-stat {
			padding: 4px 8px;
			border-radius: 4px;
			font-size: 11px;
			font-weight: 700;
		}

		.wl-stat.wins {
			background: rgba(34,197,94,0.15);
			color: #34d399;
			border: 1px solid rgba(34,197,94,0.3);
		}

		.wl-stat.losses {
			background: rgba(239,68,68,0.15);
			color: #f87171;
			border: 1px solid rgba(239,68,68,0.3);
		}

		.map-cards {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
			gap: 10px;
		}

		.map-card {
			background: rgba(255,255,255,0.03);
			border: 1px solid rgba(255,255,255,0.08);
			border-radius: 8px;
			padding: 10px;
		}

		.map-name {
			font-weight: 700;
			font-size: 13px;
			margin-bottom: 4px;
		}

		.map-stats-text {
			font-size: 10px;
			color: rgba(255,255,255,0.7);
		}

		/* Optimized sidebar layout */
		.sidebar {
			display: flex;
			flex-direction: column;
			gap: 16px;
		}

		.recent-matches {
			display: grid;
			grid-template-columns: repeat(5, 1fr);
			gap: 6px;
		}

		.match-result {
			height: 24px;
			border-radius: 4px;
			display: flex;
			align-items: center;
			justify-content: center;
			font-weight: 800;
			font-size: 11px;
		}

		.match-result.win {
			background: rgba(34,197,94,0.15);
			color: #34d399;
			border: 1px solid rgba(34,197,94,0.3);
		}

		.match-result.loss {
			background: rgba(239,68,68,0.15);
			color: #f87171;
			border: 1px solid rgba(239,68,68,0.3);
		}

		/* Responsive design improvements */
		@media (max-width: 1024px) {
			.dashboard {
				grid-template-columns: 1fr;
				max-width: 800px;
			}
			
			.header {
				flex-direction: column;
				text-align: center;
				gap: 12px;
			}
			
			.points-display {
				text-align: center;
			}
		}

		@media (max-width: 768px) {
			.stats-grid {
				grid-template-columns: 1fr;
				gap: 16px;
			}
			
			.map-stats {
				grid-template-columns: 1fr;
				gap: 12px;
			}
			
			.kd-circle {
				width: 120px;
				height: 120px;
			}
			
			.recent-matches {
				grid-template-columns: repeat(10, 1fr);
			}
		}
	</style>
</head>
<body>
	<div class="dashboard">
		<div class="card header">
			<img class="avatar" src="{{ stats.avatar_url|default('', true) }}" alt="Player Avatar">
			<div class="player-info">
				<div class="player-name">
					<h1>{{ stats.name|default('Player', true) }}</h1>
					<img class="level-badge" src="level_icons/{{ stats.level or 1 }}.png" alt="Level {{ stats.level or 1 }}">
				</div>
				<div class="player-id">ID: {{ stats.player_id|default('-', true) }}</div>
			</div>
			<div class="points-display">
				<div class="points-label">Points</div>
				<div class="points-value">{{ stats.points|default(0, true) }}</div>
			</div>
		</div>

		<div class="main-content">
			<div class="card section">
				<div class="section-title">Statistics</div>
				<div class="stats-grid">
					<div class="kd-display">
						<div class="kd-circle" style="--killsP: {{ (stats.kills / (stats.kills + stats.deaths) * 100) if (stats.kills + stats.deaths) > 0 else 0 }}">
							<div class="kd-value">{{ stats.kd|default('0.0', true) }}</div>
						</div>
						<div class="kd-stats">
							<div class="kd-stat">
								<div class="kd-stat-label">Kills</div>
								<div class="kd-stat-value">{{ stats.kills|default(0, true) }}</div>
							</div>
							<div class="kd-stat">
								<div class="kd-stat-label">Deaths</div>
								<div class="kd-stat-value">{{ stats.deaths|default(0, true) }}</div>
							</div>
						</div>
					</div>
					<div class="performance-stats">
						<div class="stat-card">
							<div class="stat-label">AVG</div>
							<div class="stat-value">{{ stats.avg|default('—', true) }}</div>
							<div class="stat-bar" style="--progress: {{ (stats.avg or 0) * 5 }}%"></div>
						</div>
						<div class="stat-card">
							<div class="stat-label">Assists</div>
							<div class="stat-value">{{ stats.assists|default(0, true) }}</div>
							<div class="stat-bar" style="--progress: {{ (stats.assists or 0) % 100 }}%"></div>
						</div>
					</div>
				</div>
			</div>

			<div class="card section">
				<div class="section-title">Map Statistics</div>
				<div class="map-stats">
					<div class="winrate-display">
						<div class="winrate-circle" style="--winrate: {{ stats.win_rate or 0 }}">
							<div class="winrate-value">{{ stats.win_rate|default(0, true) }}%</div>
						</div>
						<div class="winrate-label">Win Rate</div>
						<div class="wl-stats">
							<div class="wl-stat wins">W {{ stats.wins|default(0, true) }}</div>
							<div class="wl-stat losses">L {{ stats.losses|default(0, true) }}</div>
						</div>
					</div>
					<div class="map-cards">
						{% for m in stats.maps or [] %}
						<div class="map-card">
							<div class="map-name">{{ m.name }}</div>
							<div class="map-stats-text">K/D {{ m.kd|default('—', true) }} • W/R {{ m.win_rate|default('—', true) }}%</div>
						</div>
						{% endfor %}
					</div>
				</div>
			</div>
		</div>

		<div class="sidebar">
			<div class="card section">
				<div class="section-title">Recent Matches</div>
				<div class="recent-matches">
					{% for r in stats.recent or [] %}
					<div class="match-result {% if r == 'W' %}win{% else %}loss{% endif %}">{{ r }}</div>
					{% endfor %}
				</div>
			</div>
		</div>
	</div>
</body>
</html>
